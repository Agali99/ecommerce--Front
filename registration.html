<!DOCTYPE html>
<html>
<head>
  <title>Registration</title>
  <link rel="stylesheet" type="text/css" href="styles/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="styles/login-style.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

</head>
<body>
  <!-- <section class="vh-100"> -->
    <div class="container-fluid h-custom">
      <div class="row d-flex justify-content-center align-items-center h-100">

        <div class="col-md-9 col-lg-6 col-xl-5">
          <img src="img/logo.png" class="img-fluid" alt="Logo">
        </div>

        <div class="col-md-8 col-lg-6 col-xl-4 offset-xl-1">
          <form action="">

            <div class="text-uppercase d-flex flex-row align-items-center justify-content-center justify-content-lg-start">
              <p class="lead fw-normal mb-0 mt-3">Qeydiyyat</p>
            </div>

            <div class="divider d-flex my-4"></div>

            <div class="" id="message" style="color: red"></div>
			      <div class="form-outline mb-3">
              <input type="text" name="firstname" id="firstname" class="form-control form-control" placeholder="Ad" required/>
              <!-- <label class="form-label" for="firstname">First name</label> -->
            </div>

			      <div class="form-outline mb-3">
              <input type="text" name="lastname" id="lastname" class="form-control form-control" placeholder="Soyad" required/>
              <!-- <label class="form-label" for="lastname">Last name</label> -->
            </div>

            <div class="form-outline mb-3">
              <input type="text" name="username" id="username" class="form-control form-control" placeholder="İstifadəçi adı" required/>
              <!-- <label class="form-label" for="username">Username</label> -->
            </div>

            <div class="form-outline mb-3">
              <input type="email" name="email" id="email" class="form-control form-control" placeholder="E-poçt ünvanı" required/>
              <!-- <label class="form-label" for="email">Email address</label> -->
            </div>

            <div class="form-outline mb-3">
              <input type="password" id="password" class="form-control form-control" placeholder="Parol" required/>
              <!-- <label class="form-label" for="password">Password</label> -->
            </div>

            <div class="form-outline mb-3">
              <input type="password" id="confirm_password" class="form-control form-control" placeholder="Parolu təsdiqlə" required/>
              <!-- <label class="form-label" for="confirm_password">Confirm Password</label> -->
            </div>

            <div class="d-flex justify-content-between align-items-center">
              <div class="form-check mb-0">
                <input class="form-check-input me-2" type="checkbox" value="" id="is_seller" onclick="show();"/>
                <label class="form-check-label" for="seller">Satıcıyam</label>
              </div>
            </div>

            <div class="form-outline mb-3">
              <input type="text" name="storename" id="storename" class="form-control form-control" placeholder="Mağaza adı"/>
              <!-- <label class="form-label" for="storename">Store Name</label> -->
            </div>

			      <!-- <div class="row border pt-3" id="sellerdetails"> -->
			      <div class="form-outline mb-3">
              <input type="text" name="phonenumber" id="phonenumber" class="form-control form-control" placeholder="Nömrə"/>
              <!-- <label class="form-label" for="phonenumber">Phone Number</label> -->
            </div>

            <div class="form-outline mb-3">
              <input type="text" name="postalcode" id="postalcode" class="form-control form-control" placeholder="Poçt nömrəsi"/>
              <!-- <label class="form-label" for="storename">Store Name</label> -->
            </div>

            <div class="form-outline mb-3">
              <input type="text" id="country" class="form-control form-control" placeholder="Ölkə" />
              <!-- <label class="form-label" for="address">Country</label> -->
            </div>

            <div class="form-outline mb-3">
              <input type="text" id="city" class="form-control form-control" placeholder="Şəhər" />
              <!-- <label class="form-label" for="address">City</label> -->
            </div>

            <div class="form-outline mb-3">
              <input type="text" id="address" class="form-control form-control" placeholder="Ünvan" />
              <!-- <label class="form-label" for="address">Address</label> -->
            </div>
            <!-- </div> -->

            <div class="text-center text-lg-start mt-2 pt-2">
              <button type="button" class="btn btn-primary btn-lg" style="padding-left: 2.5rem; padding-right: 2.5rem;" onclick="register()">
                Qeydiyyat
              </button>
              <a href="./login.html" class="text-body">Giriş səhifəsinə qayıt</a>
            </div>
            <!-- <ul class="results" id="results">

            </ul> -->
          </form>
        </div>
      </div>
    </div>
    <div class="d-flex flex-md-row text-center text-md-start justify-content-between py-4 px-4 px-xl-5 bg-primary mt-5">
      <!-- Copyright -->
      <div class="text-white mb-3 mb-md-0">
        Copyright © 2022. Bütün hüquqlar qorunur.
      </div>
    </div>
  <!-- </section> -->

  <script type="text/javascript">
    function register(){
      clearBox("message")
      var url = 'http://34.68.142.7:30003/api/user/register';

      var firstName = document.getElementById("firstname").value;
      var lastName = document.getElementById("lastname").value;
      var username = document.getElementById("username").value;
      var email = document.getElementById("email").value;
      var password = document.getElementById("password").value;
      var confirmPassword = document.getElementById("confirm_password").value;
      var phoneNumber = document.getElementById("phonenumber").value;
      var storeName = document.getElementById("storename").value;
      var postalCode = document.getElementById("postalcode").value;
      var address = document.getElementById("address").value;
      var country = document.getElementById("country").value;
      var city = document.getElementById("city").value;

      var isSeller = false;
      if(document.getElementById("is_seller").checked)
        isSeller = true;
      else {
        isSeller = false;
      }
      console.log("Clicked!!!")

      if(firstName.length == "") {
        document.getElementById("message").innerHTML = "Ad  xanası boş qala bilməz"
        return 0;
      }
      else if(lastName.length == "") {
        document.getElementById("message").innerHTML = "Soyad  xanası boş qala bilməz"
        return 0;
      }
      else if(username.length == "") {
        document.getElementById("message").innerHTML = "İstifadəçi adı  xanası boş qala bilməz"
        return 0;
      }
      else if(email.length == "") {
        document.getElementById("message").innerHTML = "E-poçt xanası boş qala bilməz"
        return 0;
      }
      else if(password.length == "") {
        document.getElementById("message").innerHTML = "Parol xanası boş qala bilməz"
        return 0;
      }
      else if(confirmPassword.length == "") {
        document.getElementById("message").innerHTML = "Parolu təsdiqlə xanası boş qala bilməz"
        return 0;
      }
      else if( password != confirmPassword){
        document.getElementById("message").innerHTML = "Parollar eyni olmalıdır"
        return 0;
      }
      else if(phoneNumber.length == "") {
        document.getElementById("message").innerHTML = "Nömrə xanası boş qala bilməz"
        return 0;
      }
      else if(postalCode.length == "") {
        document.getElementById("message").innerHTML = "Poçt nömrəsi xanası boş qala bilməz"
        return 0;
      }
      else if(address.length == "") {
        document.getElementById("message").innerHTML = "Ünvan xanası boş qala bilməz"
        return 0;
      }
      else if(country.length == "") {
        document.getElementById("message").innerHTML = "Ölkə xanası boş qala bilməz"
        return 0;
      }
      else if(city.length == "") {
        document.getElementById("message").innerHTML = "Şəhər xanası boş qala bilməz"
        return 0;
      }

      if(isSeller){
        if(storeName.length == "") {
          document.getElementById("message").innerHTML = "Mağaza adı xanası boş qala bilməz"
          return 0;
        }
      }

      console.log(isSeller);

      $.ajax({
        type: 'POST',
        url: url,
        data: JSON.stringify({
          'firstName':firstName,
          'lastName':lastName,
          'username':username,
          'email':email,
          'password':password,
          'phoneNumber':phoneNumber,
          'storeName':storeName,
          'postalCode':postalCode,
          'address':address,
          'country':country,
          'city':city,
          'customer': isSeller
        }),
        contentType : 'application/json; charset=utf-8',
        dataType:'json',
        success:function(data){
          $(location).prop('href', "./register_success.html")
        },
        error: function (XMLHttpRequest, textStatus, errorThrown){
          $('#message').append('Username or password is incorrect')
          console.log("Error")
        }
      });
    }

    function clearBox(elementID)
    {
        document.getElementById(elementID).innerHTML = "";
    }
  </script>

  <script type="text/javascript">

  	window.onload = function() {
  	  document.getElementById('storename').style.display = 'none';
  	};

  	function show(){
  		var x = document.getElementById("storename");
	  	if (x.style.display === "block") {
	    	x.style.display = "none";
	  	} else {
	    	x.style.display = "block";
	  	}
  	}

  </script>

</body>
</html>
